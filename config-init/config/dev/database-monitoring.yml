druid:
  stat-view-servlet:
    enabled: true
    url-pattern: /druid/*
    reset-enable: false
    login-username: admin
    login-password: druid@2024
    allow: 127.0.0.1,192.168.0.0/16
    deny: 
  
  web-stat-filter:
    enabled: true
    url-pattern: /*
    exclusions: "*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"
    
  aop-patterns: com.xiaoxin.iam.*.service.*
  filters: stat,wall,log4j2
  
  filter:
    stat:
      enabled: true
      log-slow-sql: true
      slow-sql-millis: 2000
      merge-sql: true
    wall:
      enabled: true
      config:
        multi-statement-allow: true
        none-base-statement-allow: true
        comment-allow: true
        
datasource:
  performance:
    initial-size: 5
    min-idle: 5
    max-active: 50
    max-wait: 60000
    
    validation-query: SELECT 1
    test-while-idle: true
    test-on-borrow: false
    test-on-return: false
    
    time-between-eviction-runs-millis: 60000
    min-evictable-idle-time-millis: 300000
    max-evictable-idle-time-millis: 900000
    
    pool-prepared-statements: true
    max-pool-prepared-statement-per-connection-size: 20
    
    remove-abandoned: true
    remove-abandoned-timeout: 1800
    log-abandoned: true
    
    connection-error-retry-attempts: 3
    break-after-acquire-failure: true
    
monitoring:
  metrics:
    connection-pool:
      - active-count
      - idle-count
      - wait-count
      - connect-count
      - close-count
      
    sql-execution:
      - execute-count
      - execute-time
      - slow-sql-count
      - error-count
      
    transaction:
      - commit-count
      - rollback-count
      - transaction-time
      
  alerts:
    connection-pool:
      active-rate-threshold: 0.8
      wait-count-threshold: 10
      
    sql-performance:
      slow-sql-threshold: 2000
      error-rate-threshold: 0.01
      
    transaction:
      rollback-rate-threshold: 0.05
      long-transaction-threshold: 30000

